{% extends "layout.html" %}
{% block body %}
<div class="row">
  <div class="col-md-12">
    <div class="panel panel-default">
      <div class="panel-heading"> Information</div>

      <div class="panel-body">
        <strong>Sugested Anomaly Type:</strong> {{ anomalyType }}<br />
        <strong>Range:</strong> {{ anomalyStartTimestamp }} - {{ anomalyEndTimestamp }} <br />
        <strong>Anomaly Certainty</strong> {{ certantyPercentage }}% <br />
      </div>
    </div>
   </div>

    <div class="col-md-12">
      <div class="panel panel-default">
        <div class="panel-heading">Price</div>
        <div class="panel-body">

          <div id="price_chart" style="style="min-height: 500px""></div>
        </div>
      </div>
    </div>

    <div class="col-md-12">
      <div class="panel panel-default">
        <div class="panel-heading">Volume</div>
        <div class="panel-body">

          <div id="volume_chart" style="style="min-height: 500px""></div>
        </div>
      </div>
    </div>

</div>
<div class="row">
  <div class="col-lg-12">
    <div class="panel panel-default">
      <div class="panel-heading">
        <i class="fa fa-bar-chart-o fa-fw"></i> Data
      </div>
      <div class="panel-body">
        <div class="row">
          <div class="col-lg-12">
            <div class="table-responsive">
              <table class="table table-bordered table-hover table-striped">
                <thead>
                  <tr>
                    <th>Time</th>
                    <th>Buyer</th>
                    <th>Seller</th>
                    <th>Price</th>
                    <th>Size</th>
                    <th>Currency</th>
                    <th>Symbol</th>
                    <th>Sector</th>
                    <th>Bid</th>
                    <th>Ask</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>{{ time }}</td>
                    <td>{{ buyer }}</td>
                    <td>{{ seller}}</td>
                    <td>{{ price }}</td>
                    <td>{{ size}}</td>
                    <td>{{ currency }}</td>
                    <td>{{ symbol }}</td>
                    <td>{{ sector }}</td>
                    <td>{{ bid }}</td>
                    <td>{{ ask }}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<!-- Price Graph -->
<script type="text/javascript">
google.charts.load('current', {'packages':['corechart']});
google.charts.setOnLoadCallback(drawChart);

function drawChart() {
  var data = google.visualization.arrayToDataTable([
		  ['Time', 'Price'],
		  {%- for trade in trades %}
		  ['{{ trade.time }}', {{ trade.price }}]{%- if not loop.last %},{% endif %}
		  {%- endfor %}
  ]);

  var options = {
    title: 'Prices of most recent trades',
    legend: { position: 'bottom' },
    chartArea: { height: "40%", width: "90%" },
    series: {
	7: { pointShape: {type: 'star'}}
    }
  };

  var chart = new google.visualization.LineChart(document.getElementById('price_chart'));

  chart.draw(data, options);
}
</script>
<!-- Volume Graph -->
<script type="text/javascript">
google.charts.load('current', {'packages':['corechart']});
google.charts.setOnLoadCallback(drawChart);

function drawChart() {
  var data = google.visualization.arrayToDataTable([
		  ['Time', 'Volume'],
		  {%- for trade in trades %}
		  ['{{ trade.time }}', {{ trade.size }}]{%- if not loop.last %},{% endif %}
		  {%- endfor %}
  ]);

  var options = {
    title: 'Volume of most recent trades',
    legend: { position: 'bottom' },
    chartArea: { height: "40%", width: "90%" }
  };

  var chart = new google.visualization.LineChart(document.getElementById('volume_chart'));

  chart.draw(data, options);
}
</script>
</script>
{% endblock %}


{% block scripts %}
<script src="{{ url_for('static', filename='js/anomaly.js') }}"></script>
{% endblock %}
